<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Cyber RiskPlay</title>
<script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.js"></script>
<style>
body { margin:0; background:black; }
</style>
</head>
<body>

<script>
let balance = 1000;
let tickets = 0;

class SlotScene extends Phaser.Scene {
    constructor(){ super("SlotScene"); }

    preload(){
        this.load.image('particle','https://labs.phaser.io/assets/particles/yellow.png');
    }

    create(){
        this.cameras.main.setBackgroundColor('#0f0222');

        // Neon title
        let title = this.add.text(400,60,"CYBER SLOT",{fontSize:"42px",color:"#00ffff"}).setOrigin(0.5);
        this.tweens.add({
            targets:title,
            alpha:0.6,
            yoyo:true,
            repeat:-1,
            duration:1000
        });

        this.balanceText=this.add.text(20,20,"Balance: "+balance,{fontSize:"20px",color:"#ff00ff"});
        this.ticketText=this.add.text(20,50,"Tickets: "+tickets,{fontSize:"20px",color:"#00ffff"});

        this.reels=[];
        for(let i=0;i<3;i++){
            let reel=this.add.text(300+i*100,250,"â“",{fontSize:"70px"}).setOrigin(0.5);
            this.reels.push(reel);
        }

        let spinBtn=this.add.text(400,420,"SPIN",{fontSize:"30px",backgroundColor:"#00ffff"}).setOrigin(0.5).setInteractive();
        spinBtn.on("pointerdown",()=>this.spin());

        let arenaBtn=this.add.text(400,480,"ENTER ARENA",{fontSize:"22px",backgroundColor:"#ff00ff"}).setOrigin(0.5).setInteractive();
        arenaBtn.on("pointerdown",()=>this.scene.start("ArenaScene"));
    }

    spin(){
        if(balance<50) return;
        balance-=50;
        this.balanceText.setText("Balance: "+balance);

        let symbols=["ðŸ’°","âš¡","ðŸŽŸ","ðŸ’Ž","â­"];
        this.reels.forEach((reel,i)=>{
            this.tweens.add({
                targets:reel,
                y:300,
                yoyo:true,
                repeat:6,
                duration:80,
                onComplete:()=>{
                    let sym=symbols[Math.floor(Math.random()*symbols.length)];
                    reel.setText(sym);

                    let win=0;
                    if(sym==="ðŸ’°") win=100;
                    if(sym==="âš¡") win=50;
                    if(sym==="ðŸ’Ž") win=500;
                    if(sym==="â­") win=200;
                    if(sym==="ðŸŽŸ") tickets++;

                    balance+=win;

                    if(win>=500) this.bigWin();

                    this.balanceText.setText("Balance: "+balance);
                    this.ticketText.setText("Tickets: "+tickets);
                }
            });
        });
    }

    bigWin(){
        let text=this.add.text(400,200,"JACKPOT!",{
            fontSize:"50px",
            color:"#ffff00"
        }).setOrigin(0.5);

        this.tweens.add({
            targets:text,
            scale:1.5,
            alpha:0,
            duration:1000,
            onComplete:()=>text.destroy()
        });

        let particles=this.add.particles(400,200,'particle',{
            speed:{min:100,max:300},
            scale:{start:1,end:0},
            blendMode:'ADD',
            lifespan:1000,
            quantity:20
        });

        this.time.delayedCall(1000,()=>particles.destroy());
        this.cameras.main.shake(300,0.01);
    }
}

class ArenaScene extends Phaser.Scene {
    constructor(){ super("ArenaScene"); }

    preload(){
        this.load.image('particle','https://labs.phaser.io/assets/particles/yellow.png');
    }

    create(){
        this.cameras.main.setBackgroundColor('#000814');

        if(tickets<1){
            this.add.text(400,300,"NO TICKET",{fontSize:"40px",color:"red"}).setOrigin(0.5);
            return;
        }

        tickets--;

        this.score=0;
        this.scoreText=this.add.text(20,20,"Score: 0",{fontSize:"20px",color:"#00ffff"});

        this.target=this.add.circle(400,300,30,0xff0000);
        this.head=this.add.circle(400,300,10,0xffff00);

        this.target.setInteractive();

        this.target.on("pointerdown",(pointer)=>{
            let dist=Phaser.Math.Distance.Between(pointer.x,pointer.y,this.target.x,this.target.y);
            let points=dist<12?2:1;
            this.score+=points;
            this.scoreText.setText("Score: "+this.score);

            this.hitEffect(pointer.x,pointer.y);
            this.spawnTarget();
        });

        this.spawnTarget();

        this.timeLeft=20;
        this.timeEvent=this.time.addEvent({
            delay:1000,
            callback:()=>{
                this.timeLeft--;
                if(this.timeLeft<=0) this.endGame();
            },
            loop:true
        });

        let backBtn=this.add.text(20,550,"BACK",{fontSize:"20px",backgroundColor:"#ff00ff"}).setInteractive();
        backBtn.on("pointerdown",()=>this.scene.start("SlotScene"));
    }

    spawnTarget(){
        let x=Phaser.Math.Between(200,600);
        let y=Phaser.Math.Between(150,450);

        this.tweens.add({targets:this.target,x:x,y:y,duration:300});
        this.tweens.add({targets:this.head,x:x,y:y,duration:300});
    }

    hitEffect(x,y){
        let particles=this.add.particles(x,y,'particle',{
            speed:{min:50,max:200},
            scale:{start:0.5,end:0},
            blendMode:'ADD',
            lifespan:500,
            quantity:10
        });
        this.time.delayedCall(500,()=>particles.destroy());
    }

    endGame(){
        balance+=this.score*40;
        this.scene.start("SlotScene");
    }
}

const config={
    type:Phaser.AUTO,
    width:800,
    height:600,
    scene:[SlotScene,ArenaScene]
};

new Phaser.Game(config);
</script>

</body>
</html>
